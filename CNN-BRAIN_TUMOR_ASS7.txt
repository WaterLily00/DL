7 Build Brain tumor classification model with CNN .,

code :-


# 1️ IMPORT LIBRARIES .,

import zipfile                     # To extract compressed ZIP dataset files
import os                          # For handling file paths and directory operations
import random                      # For selecting random images for predictions
import numpy as np                 # For numerical operations and array manipulations
import matplotlib.pyplot as plt    # For plotting graphs and showing sample images

# TensorFlow and Keras modules for deep learning
      
import tensorflow as tf  
from tensorflow.keras.preprocessing.image import ImageDataGenerator, image          # Loads & augments images
from tensorflow.keras.models import Sequential                                      # Builds the CNN model layer by layer
from tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense, Dropout   # CNN and Dense layers


train_dir=r"C:\Users\sapar\Downloads\brain tumour\Training"
test_dir=r"C:\Users\sapar\Downloads\brain tumour\Testing"


train_datagen= ImageDataGenerator(rescale=1./255)
test_datagen= ImageDataGenerator(rescale=1./255)


train_gen=train_datagen.flow_from_directory(
    train_dir,
    target_size=(150,150),
    batch_size=(128),
    class_mode='categorical')


test_gen=train_datagen.flow_from_directory(
    test_dir,
    target_size=(150,150),
    batch_size=(128),
    class_mode='categorical')


model = Sequential([
    Conv2D(32,(3,3),activation='relu',input_shape=(150,150,3)),
    MaxPooling2D(2,2),

    Conv2D(64,(3,3),activation='relu'),
    MaxPooling2D(2,2),

    Conv2D(128,(3,3),activation='relu'),
    MaxPooling2D(2,2),

    Flatten(),
    Dense(256,activation='relu'),
    Dropout(0.5),
    Dense(4,activation='softmax')
])



model.compile(optimizer='adam',
                loss='categorical_crossentropy',
                metrics=['accuracy'])


history=model.fit(train_gen,epochs=10,validation_data=test_gen)


test_loss,test_acc=model.evaluate(test_gen)
print("test_acc" , test_acc*100)


plt.plot(H.history['loss'], label='Training Loss')
plt.plot(H.history['accuracy'], label='Training Accuracy')
plt.title("Training Performance")
plt.xlabel("Epochs")
plt.ylabel("Value")
plt.legend()
plt.show()


class_labels = list(train_gen.class_indices.keys())

# Pick random image from test folder
cls = random.choice(os.listdir(test_dir))
img_name = random.choice(os.listdir(os.path.join(test_dir, cls)))
img_path = os.path.join(test_dir, cls, img_name)

# Load and show image
img = tf.keras.utils.load_img(img_path, target_size=(150,150))
plt.imshow(img)
plt.axis('off')

# Predict
x = np.expand_dims(tf.keras.utils.img_to_array(img)/255.0, axis=0)
pred = model.predict(x)
plt.title(f"Actual: {cls} | Predicted: {class_labels[np.argmax(pred)]}")
plt.show()





# THEORY :- 

# CNN Architecture:
 Input → Conv2D → ReLU → Pooling → Conv2D → ReLU → Pooling →
 Conv2D → Pooling → Flatten → Dense → Softmax

# Key Concepts:
 - Convolution extracts spatial features.
 - MaxPooling reduces feature map size and computation.
 - ReLU introduces non-linearity.
 - Flatten converts 2D to 1D vector for Dense layers.
 - Dense layers learn decision boundaries.
 - Softmax gives probability distribution over 4 classes.

# Important Formulas:
 1. Convolution: Z(i,j) = Σ_m Σ_n (Input(i+m,j+n) × Kernel(m,n)) + b
 2. ReLU: f(z) = max(0, z)
 3. Softmax: σ(z_i) = e^(z_i) / Σ_j e^(z_j)
 4. Loss: L = -Σ(y_true * log(y_pred))

# Model Summary:
 This CNN learns to classify brain MRI images into 4 tumor categories
 (e.g., glioma, meningioma, pituitary, or no tumor) by extracting 
 key visual features from training data.

